<?xml version="1.0" encoding="ISO-8859-1"?>
<scenario name="">


    <recv request="INVITE" rrs="true" crlf="true">
        <action>
            <ereg regexp="&lt;(.*)&gt;" search_in="hdr" header="Contact:" check_it="true" assign_to="remote_contact,remote_contact_uri" occurrence="1" />
            <log message="Regex action log: hdr=Contact, regex=&lt;(.*)&gt;, var=remote_contact, value=[$remote_contact]" />
            <log message="Regex action log: hdr=Contact, regex=&lt;(.*)&gt;, var=remote_contact_uri, value=[$remote_contact_uri]" />
        </action>
    </recv>


    <pause distribution="uniform" min="100" max="300" />

    <send>
        <![CDATA[
SIP/2.0 100 Trying
[last_Via:]
[last_From:]
[last_To:]
[last_Call-ID:]
[last_CSeq:]
Contact: [field0] <sip:[field0]@[local_ip]:[local_port]>
[last_Record-Route:]
Content-Length: [len]
]]>
    </send>

    <pause distribution="uniform" min="100" max="300" />

    <nop>
        <action>
            <assignstr assign_to="last_from_hdr_with_hdr_name_and_tag" value="[last_From:]" />
            <ereg regexp="From:\s+(.*)" search_in="var" variable="last_from_hdr_with_hdr_name_and_tag" check_it="true" assign_to="_,uas_them_hdr" />
            <assignstr assign_to="last_to_hdr_with_hdr_name_and_tag" value="[last_To:];tag=CALLEE[call_number]" />
            <ereg regexp="To:\s+(.*)" search_in="var" variable="last_to_hdr_with_hdr_name_and_tag" check_it="true" assign_to="_,uas_us_hdr" />
        </action>
    </nop>
    <Reference variables="uas_them_hdr,uas_us_hdr" />
    <send>
        <![CDATA[
SIP/2.0 180 Ringing
[last_Via:]
[last_From:]
[last_To:];tag=CALLEE[call_number]
[last_Call-ID:]
[last_CSeq:]
Contact: [field0] <sip:[field0]@[local_ip]:[local_port]>
[last_Record-Route:]
Content-Length: [len]
]]>
    </send>

    <pause milliseconds="2000" />

    <send>
        <![CDATA[
SIP/2.0 200 OK
[last_Via:]
[last_From:]
[last_To:];tag=CALLEE[call_number]
[last_Call-ID:]
[last_CSeq:]
Contact: [field0] <sip:[field0]@[local_ip]:[local_port]>
[last_Record-Route:]
Content-Type: application/sdp
Content-Length: [len]

v=0
o=- 53655765 2353687637 IN IP[local_ip_type] [local_ip]
s=-
c=IN IP[local_ip_type] [local_ip]
b=AS:84
t=0 0
a=X-nat:3
m=audio 40000 RTP/AVP 0 96
c=IN IP[media_ip_type] [media_ip]
b=TIAS:64000
a=rtcp:40001 IN IP[media_ip_type] [media_ip]
a=sendrecv
a=rtpmap:0 PCMU/8000
a=rtpmap:96 telephone-event/8000
a=fmtp:96 0-15
]]>
    </send>

    <recv request="ACK" rrs="true" crlf="true">
        <action></action>
    </recv>


    <pause distribution="uniform" min="2000" max="4000" />


    <send>
        <![CDATA[
BYE [$remote_contact_uri] SIP/2.0
Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]
From: [$uas_us_hdr]
To: [$uas_them_hdr]
[last_Call-ID:]
[routes]
CSeq: [cseq] BYE
Max-Forwards: 70
Content-Length: [len]
]]>
    </send>

    <recv response="200" rtd="true" rrs="false" optional="false" />


    <!-- definition of the response time repartition table (unit is ms)   -->
    <ResponseTimeRepartition value="10, 20, 30, 40, 50" />

    <!-- definition of the call length repartition table (unit is ms)     -->
    <CallLengthRepartition value="10, 50, 100, 500, 1000, 5000, 10000" />

</scenario>